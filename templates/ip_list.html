{% extends 'base.html' %}

  <script>
  </script>

  {% block content %}
<h1 class="ui header">
  <i class="sitemap alternate icon"></i>
  <div class="content">
    IP Addresses
    <div class="sub header">List of unique IPs interacting with the honeypot</div>
  </div>
</h1>

<table id="ipTable" class="ui celled compact table" style="margin-top: 1em;">
  <thead>
    <tr>
      <th>IP Address</th>
      <th>Last Seen</th>
      <th>Sessions</th>
      <th>URLs</th>
      <th>Files</th>
      <th class="">Details</th>
    </tr>
  </thead>
  <tbody>
    {% for ip in ips %}
    <tr>
      <td>
        <a href="/ip/{{ip}}"><strong>{{ip}}</strong></a>
      </td>
      <td>
        {{get_last_updated_for_ip(ip)}}
      </td>
      <td>
        {{get_session_count_for_ip(ip)}}
      </td>
      <td>
        {{get_urls_count_for_ip(ip)}}
      </td>
      <td>
        {{get_files_count_for_ip(ip)}}
      </td>
      <td class="">
        <a href="/ip/{{ip}}" class="ui tiny basic button">View</a>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
<script>
$( document ).ready(function() {
    const ipt = new DataTable("#ipTable");
});
</script>
{% endblock %}

